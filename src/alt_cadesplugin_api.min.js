!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):t.AltCadesPlugin=e(t.$)}(this,function(t){var e,n,i,r=function(t,e){return function(){return t.apply(e,arguments)}},o=[].slice;return t&&!e&&(e=t),i=null,n=function(){function t(t){return null==t&&(t={}),this.set=r(this.set,this),this.get=r(this.get,this),this.getParam=r(this.getParam,this),this.init=r(this.init,this),i?i:(t.timeout&&(this.timeout=t.timeout),this.cadesplugin.JSModuleVersion="2.0",this.cadesplugin.async_spawn=this.asyncSpawn,this.cadesplugin.set=function(t){return function(e){return t.pluginObject=e}}(this),window.cadesplugin=this.cadesplugin,void(i=this))}return t.prototype.checked=!1,t.prototype.cadesplugin={},t.prototype.pluginObject=null,t.prototype.timeout=2e4,t.prototype.isPromise=!!window.Promise,t.prototype.isWebkit=function(){return navigator.userAgent.match(/chrome/i)||navigator.userAgent.match(/opera/i)}(),t.prototype.asyncSpawn=function(t){var e,n,i,r;return e=function(t,e){var o,u,c;try{c=n[t](e)}catch(u){return o=u,Promise.reject(o)}return c.done?c.value:Promise.resolve(c.value).then(i,r)},n=t(Array.prototype.slice.call(arguments,1)),i=e.bind(e,"next"),r=e.bind(e,"throw"),i()},t.prototype.init=function(){return this.checked?e.when():this.isWebkit?this.initWebkit():this.initNpapi()},t.prototype.initWebkit=function(){var t,n;return e.getScript("chrome-extension://iifchhfnnmpdbibifmljnfjhpififfog/nmcades_plugin_api.js"),window.postMessage("cadesplugin_echo_request","*"),t=e.Deferred(),n=function(e){return function(e){return"cadesplugin_loaded"===e.data?setTimeout(function(){return cpcsp_chrome_nmcades.check_chrome_plugin(function(e){return function(){return e.checked=!0,t.resolve()}}(this),function(e){return function(n){return e.checked=!0,t.reject(n)}}(this))},0):void 0}}(this),window.addEventListener("message",n,!1),setTimeout(function(e){return function(){return e.checked?void 0:t.reject("timeout")}}(this),this.timeout),t},t.prototype.initNpapi=function(){var t,n;return t=e.Deferred(),n=this.isPromise?"load":"message",e(window).on(n,function(e){return function(n){var i;if(e.isPromise||"cadesplugin_echo_request"===n.data)return e.loadNpapiPlugin(),e.checked=!0,i=e.checkNpapiPlugin(),i===!0?t.resolve():t.reject(i)}}(this)),t},t.prototype.loadNpapiPlugin=function(){var t;return t=e('<object id="cadesplugin_object" type="application/x-cades" style="visibility:hidden;"></object>'),e("body").append(t),this.pluginObject=t[0]},t.prototype.checkNpapiPlugin=function(){var t,e,n,i;try{return this.createObject("CAdESCOM.About"),!0}catch(e){return t=e,n=navigator.mimeTypes["application/x-cades"],n?(i=n.enabledPlugin,i?"plugin_not_loaded_but_object_cannot_create":"error_on_plugin_load"):"plugin_unreachable"}},t.prototype.createObject=function(t){return this.pluginObject.CreateObject(t)},t.prototype.getParam=function(t,n){var i,r,o,u,c;if(i=e.Deferred(),this.isWebkit)u="string"==typeof t?this.pluginObject.CreateObjectAsync(t).then(function(t){return function(e){return n?t.extractParam(e,n):e}}(this)):this.extractParam(t,n),u.then(i.resolve,i.reject);else try{"string"==typeof t?(c=this.pluginObject.CreateObject(t),n&&(c=this.extractParam(c,n))):c=this.extractParam(t,n),i.resolve(c)}catch(o){r=o,i.reject(r.message)}return i},t.prototype.extractParam=function(t,e){return"object"==typeof e?t[e.method].apply(t,e.args):t[e]},t.prototype.get=function(){var t,e,n;return e=arguments[0],n=arguments[1],t=3<=arguments.length?o.call(arguments,2):[],this.getParam(e,n).then(function(e){return function(n){return t.length>0?(t.unshift(n),e.get.apply(e,t)):n}}(this))},t.prototype.set=function(t,n,i){var r,o,u,c;if(this.isWebkit)return c={method:"propset_"+n,args:[i]},this.get(t,c);r=e.Deferred();try{t[n]=i,r.resolve()}catch(u){o=u,r.reject(o.message)}return r},t}()});